import numpy
from lmfit import Model

def gaussian(x, a, alpha, c):

    u = x[:, 0]
    n = x[:, 1]
    return (1.0*a*n**3*u**alpha+c)

data = numpy.empty((40,3))
x = numpy.arange(1,3,1)
y = numpy.array([5*i for i in range(1,21)])
#y = numpy.array([8*i for i in range(1,16)])
xx, yy = numpy.meshgrid(x, y)
data[:,0] = xx.flatten()
data[:,1] = yy.flatten()

#data[:,2] = numpy.array([0.0038,0.0041,0.0154,0.0165,0.0423,0.0461,0.0941,0.1069,0.1830,0.2038,0.3089,0.3487,0.5040,0.5641,0.7506,0.8606,1.0796,1.2356,1.4908,1.7447,2.0038,2.3330,2.6233,3.0913,3.3105,3.8916,4.1498,4.9213,5.1477,6.0703,6.1977,7.3968,7.4637,8.8413,8.9285,10.6754,10.4677,12.4491,12.3124,14.7764]) #laplace
#data[:,2] = numpy.array([0.0032,0.0032,0.0152,0.0161,0.0444,0.0479,0.1129,0.1235,0.2026,0.2224,0.3575,0.4008,0.5675,0.6663,0.9216,1.0901,1.2721,1.5156,1.7765,2.1278,2.3576,2.8379,3.1811,3.8405,3.9585,4.7867,4.9639,6.0235,6.0772,7.4179,7.6125,9.2464,8.9206,10.8792,10.7645,13.1394,12.4796,15.2699,14.9004,18.2638]) #27pt

#data[:,2] = numpy.array([0.0032,0.0034,0.0110,0.0118,0.0287,0.0318,0.0638,0.0738,0.0123,0.1394,0.2070,0.2377,0.3387,0.3883,0.5050,0.5978,0.7274,0.8563,1.0041,1.2067,1.3495,1.6022,1.7627,2.1316,2.2240,2.6695,2.7866,3.3815,3.4513,4.1458,4.1549,5.0648,4.9945,6.0295,5.9722,7.2965,7.0027,8.4761,8.2404,10.1081]) #laplace-up
#data[:,2] = numpy.array([0.0025,0.0028,0.0110,0.0119,0.0304,0.0334,0.0761,0.0848,0.1364,0.1521,0.2404,0.2752,0.3824,0.4604,0.6222,0.7515,0.8587,1.0399,1.1953,1.4558,1.5854,1.9358,2.1358,2.6216,2.6587,3.2579,3.3307,4.0997,4.0789,5.0503,5.0958,6.2835,5.9690,7.3975,7.1833,8.9093,8.3525,10.3773,9.9739,12.39]) #27pt-up

#data[:,2] = numpy.array([0.0076,0.0079,0.0433,0.0466,0.1322,0.1453,0.2997,0.3428,0.5929,0.6952,1.0431,1.2576,1.6874,2.0164,2.5240,3.0961,3.7078,4.4712,4.9265,6.1216,6.6668,8.2959,8.6897,10.8456,11.0985,13.8625,13.9045,17.3034,17.3149,21.4352]) #classic-up
#data[:,2] = numpy.array([0.0101,0.0105,0.0639,0.0675,0.1987,0.2147,0.4530,0.5067,0.8897,1.0209,1.5675,1.8585,2.5380,2.9987,3.8121,4.6221,5.5891,6.7021,7.4658,9.1906,10.1077,12.5133,13.1937,16.3747,16.8687,20.9378,21.1622,26.2971,26.3926,32.3284]) #classic

#data[:,2] = numpy.array([0.0083,0.0083,0.0444,0.0470,0.1339,0.1448,0.3011,0.3387,0.5931,0.6893,1.0458,1.2559,1.6970,2.0129,2.5433,3.0819,3.7294,4.4430,4.9499,6.0802,6.7052,8.2310,8.7057,10.7513,11.1138,13.7201,13.9479,17.0922,17.3628,21.2003]) #classic-jacobi

#data[:,2] = numpy.array([0.0065,0.0068,0.0334,0.0360,0.0997,0.1101,0.2230,0.2584,0.4471,0.5292,0.7860,0.9542,1.2444,1.5258,1.8988,2.3100,2.7104,3.3343,3.6772,4.5460,4.9207,6.1704,6.4099,8.0351,8.2475,10.2926,10.2521,12.8691,12.7370,15.7886]) #classic-jacobi-up

data[:,2] = numpy.array([0.0024,0.0026,0.0091,0.0099,0.0239,0.0266,0.0588,0.0663,0.1043,0.1182,0.1840,0.2161,0.3045,0.3646,0.4938,0.5917,0.6824,0.8159,0.9471,1.1368,1.2526,1.5030,1.6811,2.0250,2.1017,2.5188,2.6294,3.1488,3.2174,3.8784,4.0043,4.8164,4.6985,5.6667,5.6307,6.7693,6.5641,7.9272,7.8196,9.4702]) #27pt-jacobi-up
#data[:,2] = numpy.array([0.0030,0.0032,0.0095,0.0098,0.0223,0.0251,0.0492,0.0574,0.0942,0.1074,0.1575,0.1850,0.2600,0.3018,0.3894,0.4695,0.5719,0.6729,0.7932,0.9518,1.0635,1.2639,1.3943,1.6824,1.7567,2.0967,2.2035,2.6605,2.7363,3.2382,3.2913,3.9697,3.9496,4.6987,4.7209,5.6967,5.5377,6.6087,6.5171,7.9041]) #laplace-jacobi-up

#data[:,2] = numpy.array([0.0027,0.0029,0.0121,0.0128,0.0315,0.0344,0.0784,0.0870,0.1387,0.1552,0.2440,0.2826,0.4108,0.4742,0.6663,0.7738,0.9213,1.0655,1.2781,1.4813,1.6902,1.9660,2.2670,2.6549,2.8393,3.2911,3.5562,4.1327,4.3511,5.0717,5.4248,6.3082,6.3598,7.4359,7.6281,8.8807,8.8885,10.3972,10.5989,12.3967]) #27pt-jacobi
#data[:,2] = numpy.array([0.0039,0.0038,0.0117,0.0123,0.0298,0.0327,0.0654,0.0743,0.1265,0.1400,0.2106,0.2420,0.3487,0.3936,0.5202,0.6060,0.7711,0.8729,1.0667,1.2372,1.4281,1.6508,1.8840,2.1925,2.3765,2.7498,2.9809,3.4833,3.7154,4.2638,4.4751,5.2107,5.3754,6.1942,6.4344,7.4815,7.5537,8.7150,8.8674,10.3664]) #laplace-jacobi

print 'xx\n', xx
print 'yy\n',yy
print 'data to be fit\n', data[:, 2]

a = 0.00001
alpha = 0.3
c = 0
gmod = Model(gaussian)

print 'data to be fit\n', data[:, 2]
gmod.set_param_hint('a', value=a, min=0, max=0.001)
gmod.set_param_hint('alpha', value=alpha, min=0.1, max=1)
gmod.set_param_hint('c',value=c,min=-10,max=10)
params = gmod.make_params()
result = gmod.fit(data[0:, 2], x=data[0:, 0:2], params=params)
print result.fit_report(min_correl=0.25)
gmod = Model(gaussian)
print 'data to be fit\n', data[10:, 2]
gmod.set_param_hint('a', value=a, min=0, max=0.001)
gmod.set_param_hint('alpha', value=alpha, min=0.1, max=1)
gmod.set_param_hint('c',value=c,min=-10,max=10)
params = gmod.make_params()
result = gmod.fit(data[10:, 2], x=data[10:, 0:2], params=params)
print result.fit_report(min_correl=0.25)
gmod = Model(gaussian)
print 'data to be fit\n', data[20:, 2]
gmod.set_param_hint('a', value=a, min=0, max=0.001)
gmod.set_param_hint('alpha', value=alpha, min=0.1, max=1)
gmod.set_param_hint('c',value=c,min=-10,max=10)
params = gmod.make_params()
result = gmod.fit(data[20:, 2], x=data[20:, 0:2], params=params)
print result.fit_report(min_correl=0.25)
#print result.best_values
#print result.best_fit
